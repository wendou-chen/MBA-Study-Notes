export type Locale = "en" | "zh";

const en = {
  // General
  appTitle: "Codexidian",
  localeNameEn: "English",
  localeNameZh: "Chinese",
  connected: "Connected",
  disconnected: "Disconnected",
  history: "History",
  newThread: "New Conversation",
  restart: "Restart",
  reconnect: "Reconnect",
  model: "Model",
  effort: "Thinking",
  skill: "Skill",
  mode: "Mode",
  send: "Send",
  attachImage: "Attach images",
  dropImagesHere: "Drop images here",
  sendShortcutHint: "Enter to send",
  askPlaceholder: "Ask Codex about this vault...",
  open: "Open",
  del: "Del",
  cancel: "Cancel",
  saveAndResend: "Save & Resend",
  submit: "Submit",
  approve: "Approve",
  deny: "Deny",
  alwaysAllow: "Always Allow",
  clear: "Clear",
  apply: "Apply",
  copy: "Copy",
  copied: "Copied!",
  output: "Output",
  toolTitle: "Tool",
  text: "text",
  streaming: "streaming",

  // Commands
  openCodexidianCommand: "Open Codexidian",
  startNewThreadCommand: "Codexidian: Start New Thread",
  cmdNewLabel: "New Chat",
  cmdNewDesc: "Start a new conversation tab.",
  cmdClearLabel: "Clear Chat",
  cmdClearDesc: "Clear messages in the current conversation.",
  cmdModelLabel: "Cycle Model",
  cmdModelDesc: "Switch to the next configured model.",
  cmdEffortLabel: "Cycle Effort",
  cmdEffortDesc: "Cycle thinking effort (low → medium → high → xhigh).",
  cmdHistoryLabel: "Open Sessions",
  cmdHistoryDesc: "Open the session manager modal.",
  cmdTabsLabel: "Show Tabs",
  cmdTabsDesc: "Show a summary of current tabs.",
  cmdHelpLabel: "Show Help",
  cmdHelpDesc: "List all available slash commands.",

  // Notices and system messages
  noticeStorageInitFailed: "Codexidian: storage initialization failed ({error}). Continuing without persistence.",
  noticeFileContextInitFailed: "Codexidian: failed to initialize file mention context ({error})",
  noticeImageContextInitFailed: "Codexidian: failed to initialize image paste context ({error})",
  noticeAttachmentLimitReached: "You can attach up to {max} images per turn.",
  noticeImageOnlyAttachments: "Only image files can be attached.",
  noticeImageReadFailed: "Failed to read one or more image attachments.",
  noticePersistTabStateFailed: "Codexidian: failed to persist tab state ({error})",
  noticeNoActiveTabToClear: "No active tab to clear.",
  noticeClearedConversation: "Cleared current conversation messages.",
  noticeCannotCreateTabMax: "Cannot create new tab: max tabs ({max}) reached.",
  noticeModelSet: "Model set to {model}",
  noticeEffortSet: "Thinking effort set to {effort}",
  noticeSkillSet: "Skill set to {skill}",
  noticeCollaborationModeSet: "Mode set to {mode}",
  noticeAllowRuleAdded: "Added allow rule: {type} ({pattern})",
  noticeAllowRuleExists: "Allow rule already exists: {type} ({pattern})",
  noticeAllowRuleAddFailed: "Failed to add allow rule: {error}",
  noticeAllowRuleRemoved: "Removed allow rule.",
  noticeAllowRuleRemoveFailed: "Failed to remove allow rule: {error}",
  noticeAllowRulesCleared: "Cleared all allow rules.",
  noticeAllowRulesClearFailed: "Failed to clear allow rules: {error}",
  messageNoTabsOpen: "No tabs are currently open.",
  messageTabsSummary: "Tabs {count}/{max}: {summary}",
  messageNoSlashCommands: "No slash commands are registered.",
  messageAvailableSlashCommands: "Available slash commands: {list}",
  messageQueuedCount: "{count} message queued",
  messageQueuedCountPlural: "{count} messages queued",
  messageCancelledByUser: "(Cancelled by user)",
  messageCancelRequestFailed: "Cancel request failed: {error}",
  noticeProcessQueueFailed: "Codexidian: failed to process queue ({error})",
  messageQueuedSendFailed: "Queued message failed: {error}",
  messageFailedInitConversation: "Failed to initialize conversation: {error}",
  messageReadyHint: "Ready. Click Send to start Codex in this pane.",
  messageMcpContextAttached: "MCP context attached: {paths}",
  imageAttached: "(Image attached: {name})",
  messageImageUploadUnsupported: "Image upload is not supported by this Codex app-server version.",
  messageNoAssistantOutput: "(No assistant output)",
  messageTurnFinishedStatus: "Turn finished with status {status}{suffix}",
  messageRequestFailed: "Request failed: {error}",
  noticeCodexError: "Codexidian: {error}",
  noticeImageUploadUnsupported: "Codexidian: image upload is unsupported by the current app-server.",
  messageAutoApprovedByRule: "Auto-approved by allow rule: {summary} [{pattern}]",
  messageStartedNewThread: "Started new thread: {threadId}",
  messageFailedStartNewThread: "Failed to start new thread: {error}",
  messageRestarted: "Codex app-server restarted.",
  messageRestartFailed: "Restart failed: {error}",
  historyEmpty: "No conversations yet",
  historyMessageCount: "{count} messages",
  sessionModalTitle: "Sessions",
  sessionSearchPlaceholder: "Search sessions by title or content...",
  sessionFilterAll: "All",
  sessionFilterActive: "Active",
  sessionFilterArchived: "Archived",
  sessionFilterPinned: "Pinned",
  sessionOpen: "Open",
  sessionFork: "Fork",
  sessionPin: "Pin",
  sessionUnpin: "Unpin",
  sessionArchive: "Archive",
  sessionUnarchive: "Unarchive",
  sessionDelete: "Delete",
  sessionEmpty: "No sessions found.",
  sessionArchivedBadge: "Archived",
  sessionMetaLine: "{date} · {count} messages",
  sessionDeleteConfirm: "Delete session '{title}'?",
  sessionActionFailed: "Session action failed: {error}",
  sessionLoadFailed: "Failed to load sessions: {error}",
  sessionForkPrefix: "Fork",
  noticeFailedLoadConversation: "Failed to load conversation",
  noticeRestoreTabsFailed: "Codexidian: failed to restore tabs ({error}), creating a fresh tab.",

  // Edit / apply
  editMessageTitle: "Edit and resend this message",
  rewindTitle: "Rewind to this message",
  forkTitle: "Fork from this message",
  noticeCannotEditRunning: "Cannot edit while a turn is running.",
  noticeCannotEditNotFound: "Cannot edit: user message not found.",
  noticeEditedMessageEmpty: "Edited message cannot be empty.",
  confirmSaveEditResend: "Save edit and resend from this point? This will remove later messages.",
  noticeEditMessageNotFound: "Unable to edit: message not found in conversation.",
  messageEditedStartedFreshThread: "Edited message. Started a fresh thread.",
  messageEditedSaveButThreadFail: "Edited message saved, but failed to start a fresh thread: {error}",
  noticeEditFailed: "Edit failed: {error}",
  noticeNoCodeToApply: "No code content to apply.",
  promptTargetNotePath: "Target note path",
  noticeTargetPathRequired: "Target note path is required.",
  securityBlocked: "Blocked by security policy: {reason}",
  securityBlockedReasonDefault: "Path matches blocklist.",
  replaceSelection: "Replace Selection",
  appendToNote: "Append to Note",
  confirmApplyCode: "Apply code to '{path}' using '{mode}'?",
  noticeAppliedCode: "Applied code to {path} ({mode}).",
  noticeApplyCodeFailed: "Failed to apply code: {error}",
  confirmApplyModeFallback: "Apply mode:\nOK = Replace Selection\nCancel = Append to Note",
  applyModeCancel: "Cancel",
  errorNoActiveEditor: "No active markdown editor found.",
  errorReplaceSelectionRequiresTarget: "Replace Selection requires the target note to be open and active.",
  errorNoSelectionToReplace: "No selected text to replace.",
  errorMaxSizeExceeded: "Resulting note exceeds max size ({kb} KB).",
  errorTargetPathNotFile: "Target path is not a file: {path}",

  // Rewind/Fork
  noticeCannotRewindRunning: "Cannot rewind while a turn is running.",
  confirmRewind: "Rewind to this message? Messages after it will be removed.",
  noticeUnableRewind: "Unable to rewind: message not found.",
  messageRewindComplete: "Rewind complete. Started a fresh thread.",
  messageRewindThreadFail: "Rewind succeeded, but failed to start new thread: {error}",
  noticeRewindFailed: "Rewind failed: {error}",
  noticeCannotForkRunning: "Cannot fork while a turn is running.",
  noticeCannotForkMax: "Cannot fork: max tabs ({max}) reached.",
  noticeUnableFork: "Unable to fork: message not found.",
  messageForkCreated: "Fork created with a fresh thread.",
  messageForkThreadFail: "Fork created, but failed to start new thread: {error}",
  noticeForkFailed: "Fork failed: {error}",

  // Context
  messageContextFileNotFound: "Context file not found: {path}",
  messageContextFileReadFailed: "Failed to read context file {path}: {error}",
  noteToggleOn: "Include note: on",
  noteToggleOff: "Include note: off",
  selectionPreview: "{path} ({count} {lineLabel}): {preview}...",
  lineSingular: "line",
  linePlural: "lines",

  // Approval / input cards
  approvalTitleCommand: "Command Execution Request",
  approvalTitleFile: "File Change Request",
  approvalTitleGeneric: "Approval Request",
  approvalMetaFile: "File: {path}",
  approvalMetaCwd: "cwd: {cwd}",
  approvalTimedOut: "Timed out (auto-denied)",
  approvalDecisionPrefix: "Decision: {status}",
  approvalApproved: "Approved",
  approvalDenied: "Denied",
  approvalAlwaysAllowed: "Approved (always)",
  userInputRequest: "User Input Request",
  userInputPlaceholder: "Or type a custom answer",
  userInputTimedOutDefault: "Timed out. Used default answers.",
  userInputSubmitted: "Submitted",
  statusUserInputRequest: "User input request",

  // Status line
  running: "Running",
  idle: "Idle",
  thread: "thread",
  noThread: "no thread",
  defaultModel: "default",

  // Status panel
  statusThinking: "Thinking...",
  statusStreaming: "Streaming response...",
  statusWaitingApproval: "Waiting for approval...",
  statusRunningTool: "Running tool...",
  statusRunningGeneric: "Running...",
  statusTypeTool: "TOOL",
  reasoning: "Reasoning",
  toolOutput: "Tool output",
  toolStatusPrefix: "Tool",
  statusTypeThinking: "THINK",
  statusTypeAgent: "AGENT",
  statusTypeInfo: "INFO",
  statusRunningShort: "running",
  statusFailedShort: "failed",
  statusDoneShort: "done",

  // Review pane
  reviewTitle: "Review",
  reviewDiffsTitle: "Last turn file changes",
  reviewCommentsTitle: "Queued comments",
  reviewCommentsEmpty: "No review comments queued.",
  reviewScopePlaceholder: "Scope (file path or section)",
  reviewCommentPlaceholder: "Add review comment for next turn",
  reviewAddComment: "Add",
  reviewCommentRemove: "Remove",
  reviewStatusAdded: "added",
  reviewStatusModified: "modified",
  reviewStatusDeleted: "deleted",
  reviewPromptHeader: "Review Comments",

  // Plan mode
  planTitle: "Plan",
  planStatusProposed: "Proposed",
  planStatusApproved: "Approved",
  planStatusInProgress: "In Progress",
  planStatusCompleted: "Completed",
  planApproveAll: "Approve All",
  planGiveFeedback: "Give Feedback",
  planExecuteNext: "Execute Next",
  planFeedbackPrompt: "Plan feedback",
  planApprovedProceedMessage: "Approved. Please proceed with the plan.",
  planFeedbackMessagePrefix: "Plan feedback",
  planExecuteStepMessage: "Please execute step {index}: {description}",

  // Settings
  settingsTitle: "Codexidian Settings",
  settingLanguageName: "Language",
  settingLanguageDesc: "Choose UI language for Codexidian.",
  settingCodexCommandName: "Codex command",
  settingCodexCommandDesc: "CLI command used to launch app-server. Windows default: codex.cmd",
  settingWorkingDirName: "Working directory",
  settingWorkingDirDesc: "Root directory Codex uses for this plugin session.",
  settingModelName: "Model",
  settingModelDesc: "Select the AI model for Codex sessions.",
  settingEffortName: "Thinking effort",
  settingEffortDesc: "Control how deeply Codex thinks before responding.",
  settingSkillPresetName: "Skill",
  settingSkillPresetDesc: "Default skill for the next turn (loaded from .codex/skills).",
  settingCollaborationModeName: "Mode",
  settingCollaborationModeDesc: "Approval mode for requests: Safe, Prompt, or Yolo.",
  skillPresetNone: "None",
  skillPresetCodeReview: "Code Review",
  skillPresetExplain: "Explain",
  skillPresetRefactor: "Refactor",
  skillPresetDebug: "Debug",
  skillPresetTest: "Test",
  collaborationModeAutonomous: "Autonomous",
  collaborationModeInteractive: "Interactive",
  collaborationModePlanFirst: "Plan First",
  settingsAllowRulesSection: "Approval Allow Rules",
  settingsAllowRulesDesc: "Automatically approve matching requests without showing the approval card.",
  allowRulesEmpty: "No allow rules configured.",
  allowRuleDelete: "Delete",
  allowRulesClearAll: "Clear All",
  confirmAllowRulesClearAll: "Clear all allow rules?",
  allowRuleTypeCommand: "Command",
  allowRuleTypeFileWrite: "File Write",
  allowRuleTypeTool: "Tool",
  settingApprovalPolicyName: "Approval policy",
  settingApprovalPolicyDesc: "Codex ask-for-approval mode for new or resumed threads.",
  settingSandboxName: "Sandbox mode",
  settingSandboxDesc: "Sandbox mode for newly started or resumed threads.",
  settingAutoApproveName: "Auto-approve app-server requests",
  settingAutoApproveDesc: "If enabled, command/file approval callbacks are answered automatically.",
  settingPersistThreadName: "Persist thread across restarts",
  settingPersistThreadDesc: "Reuse the last thread id when possible.",
  settingSavedThreadName: "Saved thread",
  settingSavedThreadEmpty: "(none)",
  settingSavedThreadClear: "Clear",
  noticeSavedThreadCleared: "Codexidian saved thread cleared.",
  settingsUiSection: "UI Settings",
  settingMaxTabsName: "Max tabs",
  settingMaxTabsDesc: "Maximum number of open tabs (1-5).",
  settingContextInjectionName: "Context injection",
  settingContextInjectionDesc: "Inject current note path and editor selection into prompts.",
  settingSelectionPollingName: "Selection polling",
  settingSelectionPollingDesc: "Poll editor selection to show context indicator.",
  settingEnableReviewPaneName: "Enable review pane",
  settingEnableReviewPaneDesc: "Show the review pane (diff + queued comments) between messages and input.",
  settingsMcpSection: "MCP Integration",
  settingEnableMcpName: "Enable MCP vault tools",
  settingEnableMcpDesc: "Allow app-server tool calls to read/write/search/list notes through Obsidian vault APIs.",
  settingMcpEndpointName: "MCP endpoint (optional)",
  settingMcpEndpointDesc: "Optional endpoint metadata for external MCP/REST bridge setups.",
  settingMcpApiKeyName: "MCP API key (optional)",
  settingMcpApiKeyDesc: "Optional key for external MCP/REST bridge usage.",
  settingMcpContextLimitName: "Auto MCP context notes",
  settingMcpContextLimitDesc: "Automatically attach top related notes to each prompt when MCP is enabled (0 to disable).",
  settingsSecuritySection: "Security Controls",
  settingBlockedPathsName: "Blocked paths",
  settingBlockedPathsDesc: "One path pattern per line. Block read/write to sensitive files and folders.",
  settingRequireApprovalWriteName: "Require approval for write",
  settingRequireApprovalWriteDesc: "Require explicit approval before write operations (MCP write_note and Apply to Note).",
  settingMaxNoteSizeName: "Max note size (KB)",
  settingMaxNoteSizeDesc: "Maximum resulting note size allowed for write operations.",
  noticeNewThreadCreated: "Codexidian new thread: {threadId}...",

  // MCP service/system responses surfaced to UI
  mcpDisabledMessage: "MCP is disabled in Codexidian settings.",
  mcpToolExecutionFailed: "MCP tool execution failed: {error}",
};

const zh: typeof en = {
  // General
  appTitle: "Codexidian",
  localeNameEn: "英文",
  localeNameZh: "中文",
  connected: "已连接",
  disconnected: "未连接",
  history: "History",
  newThread: "New Conversation",
  restart: "Restart",
  reconnect: "Reconnect",
  model: "Model",
  effort: "Thinking",
  skill: "Skill",
  mode: "Mode",
  send: "Send",
  attachImage: "Attach images",
  dropImagesHere: "Drop images here",
  sendShortcutHint: "Enter to send",
  askPlaceholder: "Ask Codex about this vault...",
  open: "打开",
  del: "删",
  cancel: "取消",
  saveAndResend: "保存并重发",
  submit: "提交",
  approve: "批准",
  deny: "拒绝",
  alwaysAllow: "始终允许",
  clear: "清除",
  apply: "应用",
  copy: "复制",
  copied: "已复制",
  output: "输出",
  toolTitle: "工具",
  text: "文本",
  streaming: "流式中",

  // Commands
  openCodexidianCommand: "打开 Codexidian",
  startNewThreadCommand: "Codexidian：新建线程",
  cmdNewLabel: "新建会话",
  cmdNewDesc: "新建一个会话标签页。",
  cmdClearLabel: "清空会话",
  cmdClearDesc: "清空当前会话消息。",
  cmdModelLabel: "切换模型",
  cmdModelDesc: "切换到下一个模型。",
  cmdEffortLabel: "切换思考强度",
  cmdEffortDesc: "循环切换思考强度（low → medium → high → xhigh）。",
  cmdHistoryLabel: "会话管理",
  cmdHistoryDesc: "打开会话管理弹窗。",
  cmdTabsLabel: "显示标签概览",
  cmdTabsDesc: "显示当前标签页摘要。",
  cmdHelpLabel: "显示命令帮助",
  cmdHelpDesc: "列出所有斜杠命令。",

  // Notices and system messages
  noticeStorageInitFailed: "Codexidian：存储初始化失败（{error}），将以无持久化模式继续。",
  noticeFileContextInitFailed: "Codexidian：文件提及上下文初始化失败（{error}）",
  noticeImageContextInitFailed: "Codexidian：图片粘贴上下文初始化失败（{error}）",
  noticeAttachmentLimitReached: "每轮最多可附加 {max} 张图片。",
  noticeImageOnlyAttachments: "仅支持附加图片文件。",
  noticeImageReadFailed: "读取图片附件失败。",
  noticePersistTabStateFailed: "Codexidian：标签状态持久化失败（{error}）",
  noticeNoActiveTabToClear: "当前没有可清空的标签页。",
  noticeClearedConversation: "已清空当前会话消息。",
  noticeCannotCreateTabMax: "无法新建标签页：已达到上限（{max}）。",
  noticeModelSet: "模型已切换为 {model}",
  noticeEffortSet: "思考强度已切换为 {effort}",
  noticeSkillSet: "技能已切换为 {skill}",
  noticeCollaborationModeSet: "协作模式已切换为 {mode}",
  noticeAllowRuleAdded: "已添加允许规则：{type}（{pattern}）",
  noticeAllowRuleExists: "允许规则已存在：{type}（{pattern}）",
  noticeAllowRuleAddFailed: "添加允许规则失败：{error}",
  noticeAllowRuleRemoved: "已删除允许规则。",
  noticeAllowRuleRemoveFailed: "删除允许规则失败：{error}",
  noticeAllowRulesCleared: "已清空所有允许规则。",
  noticeAllowRulesClearFailed: "清空允许规则失败：{error}",
  messageNoTabsOpen: "当前没有打开的标签页。",
  messageTabsSummary: "标签页 {count}/{max}：{summary}",
  messageNoSlashCommands: "当前未注册斜杠命令。",
  messageAvailableSlashCommands: "可用斜杠命令：{list}",
  messageQueuedCount: "已排队 {count} 条消息",
  messageQueuedCountPlural: "已排队 {count} 条消息",
  messageCancelledByUser: "（已由用户取消）",
  messageCancelRequestFailed: "取消请求失败：{error}",
  noticeProcessQueueFailed: "Codexidian：处理队列失败（{error}）",
  messageQueuedSendFailed: "队列消息发送失败：{error}",
  messageFailedInitConversation: "初始化会话失败：{error}",
  messageReadyHint: "已就绪。点击发送即可开始在此面板使用 Codex。",
  messageMcpContextAttached: "已附加 MCP 上下文：{paths}",
  imageAttached: "（已附加图片：{name}）",
  messageImageUploadUnsupported: "当前 Codex app-server 版本不支持图片上传。",
  messageNoAssistantOutput: "（无助手输出）",
  messageTurnFinishedStatus: "本轮状态：{status}{suffix}",
  messageRequestFailed: "请求失败：{error}",
  noticeCodexError: "Codexidian：{error}",
  noticeImageUploadUnsupported: "Codexidian：当前 app-server 不支持图片上传。",
  messageAutoApprovedByRule: "命中允许规则自动批准：{summary} [{pattern}]",
  messageStartedNewThread: "已创建新线程：{threadId}",
  messageFailedStartNewThread: "创建新线程失败：{error}",
  messageRestarted: "Codex app-server 已重启。",
  messageRestartFailed: "重启失败：{error}",
  historyEmpty: "暂无会话记录",
  historyMessageCount: "{count} 条消息",
  sessionModalTitle: "会话管理",
  sessionSearchPlaceholder: "搜索会话标题或内容...",
  sessionFilterAll: "全部",
  sessionFilterActive: "进行中",
  sessionFilterArchived: "已归档",
  sessionFilterPinned: "置顶",
  sessionOpen: "打开",
  sessionFork: "分叉",
  sessionPin: "置顶",
  sessionUnpin: "取消置顶",
  sessionArchive: "归档",
  sessionUnarchive: "取消归档",
  sessionDelete: "删除",
  sessionEmpty: "未找到会话。",
  sessionArchivedBadge: "已归档",
  sessionMetaLine: "{date} · {count} 条消息",
  sessionDeleteConfirm: "确定删除会话「{title}」？",
  sessionActionFailed: "会话操作失败：{error}",
  sessionLoadFailed: "加载会话失败：{error}",
  sessionForkPrefix: "分叉",
  noticeFailedLoadConversation: "加载会话失败",
  noticeRestoreTabsFailed: "Codexidian：恢复标签失败（{error}），已创建新标签。",

  // Edit / apply
  editMessageTitle: "编辑并重发这条消息",
  rewindTitle: "回退到此消息",
  forkTitle: "从此消息分叉",
  noticeCannotEditRunning: "运行中无法编辑消息。",
  noticeCannotEditNotFound: "无法编辑：未找到用户消息。",
  noticeEditedMessageEmpty: "编辑后的消息不能为空。",
  confirmSaveEditResend: "确定保存编辑并从此处重新发送？后续消息将被移除。",
  noticeEditMessageNotFound: "无法编辑：会话中未找到该消息。",
  messageEditedStartedFreshThread: "编辑完成，已启动新线程。",
  messageEditedSaveButThreadFail: "编辑已保存，但启动新线程失败：{error}",
  noticeEditFailed: "编辑失败：{error}",
  noticeNoCodeToApply: "没有可应用的代码内容。",
  promptTargetNotePath: "目标笔记路径",
  noticeTargetPathRequired: "目标笔记路径不能为空。",
  securityBlocked: "被安全策略拦截：{reason}",
  securityBlockedReasonDefault: "路径命中禁止规则。",
  replaceSelection: "替换选区",
  appendToNote: "追加到笔记末尾",
  confirmApplyCode: "确定以“{mode}”方式将代码应用到“{path}”？",
  noticeAppliedCode: "已将代码应用到 {path}（{mode}）。",
  noticeApplyCodeFailed: "应用代码失败：{error}",
  confirmApplyModeFallback: "应用模式：\n确定 = 替换选区\n取消 = 追加到笔记",
  applyModeCancel: "取消",
  errorNoActiveEditor: "未找到活动的 Markdown 编辑器。",
  errorReplaceSelectionRequiresTarget: "“替换选区”要求目标笔记正处于打开且激活状态。",
  errorNoSelectionToReplace: "没有可替换的选中文本。",
  errorMaxSizeExceeded: "结果笔记超出大小限制（{kb} KB）。",
  errorTargetPathNotFile: "目标路径不是文件：{path}",

  // Rewind/Fork
  noticeCannotRewindRunning: "运行中无法回退。",
  confirmRewind: "确定回退到该消息？其后的消息将被移除。",
  noticeUnableRewind: "无法回退：未找到该消息。",
  messageRewindComplete: "回退完成，已启动新线程。",
  messageRewindThreadFail: "回退已完成，但启动新线程失败：{error}",
  noticeRewindFailed: "回退失败：{error}",
  noticeCannotForkRunning: "运行中无法分叉。",
  noticeCannotForkMax: "无法分叉：已达到标签页上限（{max}）。",
  noticeUnableFork: "无法分叉：未找到该消息。",
  messageForkCreated: "已创建分叉，并启动新线程。",
  messageForkThreadFail: "分叉已创建，但启动新线程失败：{error}",
  noticeForkFailed: "分叉失败：{error}",

  // Context
  messageContextFileNotFound: "上下文文件不存在：{path}",
  messageContextFileReadFailed: "读取上下文文件失败 {path}：{error}",
  noteToggleOn: "包含当前笔记：开",
  noteToggleOff: "包含当前笔记：关",
  selectionPreview: "{path}（{count}{lineLabel}）：{preview}...",
  lineSingular: "行",
  linePlural: "行",

  // Approval / input cards
  approvalTitleCommand: "命令执行请求",
  approvalTitleFile: "文件修改请求",
  approvalTitleGeneric: "审批请求",
  approvalMetaFile: "文件：{path}",
  approvalMetaCwd: "工作目录：{cwd}",
  approvalTimedOut: "超时（自动拒绝）",
  approvalDecisionPrefix: "决策：{status}",
  approvalApproved: "已批准",
  approvalDenied: "已拒绝",
  approvalAlwaysAllowed: "已批准（始终）",
  userInputRequest: "用户输入请求",
  userInputPlaceholder: "或输入自定义答案",
  userInputTimedOutDefault: "已超时，已使用默认答案。",
  userInputSubmitted: "已提交",
  statusUserInputRequest: "用户输入请求",

  // Status line
  running: "运行中",
  idle: "空闲",
  thread: "线程",
  noThread: "无线程",
  defaultModel: "默认",

  // Status panel
  statusThinking: "思考中...",
  statusStreaming: "正在流式回复...",
  statusWaitingApproval: "等待审批中...",
  statusRunningTool: "工具执行中...",
  statusRunningGeneric: "运行中...",
  statusTypeTool: "工具",
  reasoning: "推理",
  toolOutput: "工具输出",
  toolStatusPrefix: "工具",
  statusTypeThinking: "思考",
  statusTypeAgent: "代理",
  statusTypeInfo: "信息",
  statusRunningShort: "运行中",
  statusFailedShort: "失败",
  statusDoneShort: "完成",

  // Review pane
  reviewTitle: "审查",
  reviewDiffsTitle: "上一轮文件变更",
  reviewCommentsTitle: "待发送评论",
  reviewCommentsEmpty: "暂无待发送评论。",
  reviewScopePlaceholder: "范围（文件路径或区域）",
  reviewCommentPlaceholder: "为下一轮添加审查评论",
  reviewAddComment: "添加",
  reviewCommentRemove: "删除",
  reviewStatusAdded: "新增",
  reviewStatusModified: "修改",
  reviewStatusDeleted: "删除",
  reviewPromptHeader: "Review Comments",

  // Plan mode
  planTitle: "计划",
  planStatusProposed: "待审批",
  planStatusApproved: "已审批",
  planStatusInProgress: "执行中",
  planStatusCompleted: "已完成",
  planApproveAll: "全部批准",
  planGiveFeedback: "反馈",
  planExecuteNext: "执行下一步",
  planFeedbackPrompt: "计划反馈",
  planApprovedProceedMessage: "已批准，请按计划继续执行。",
  planFeedbackMessagePrefix: "计划反馈",
  planExecuteStepMessage: "请执行第 {index} 步：{description}",

  // Settings
  settingsTitle: "Codexidian 设置",
  settingLanguageName: "语言",
  settingLanguageDesc: "选择 Codexidian 的界面语言。",
  settingCodexCommandName: "Codex 命令",
  settingCodexCommandDesc: "用于启动 app-server 的 CLI 命令。Windows 默认：codex.cmd",
  settingWorkingDirName: "工作目录",
  settingWorkingDirDesc: "Codex 在本插件会话中使用的根目录。",
  settingModelName: "模型",
  settingModelDesc: "选择 Codex 会话使用的 AI 模型。",
  settingEffortName: "思考强度",
  settingEffortDesc: "控制 Codex 回复前的思考深度。",
  settingSkillPresetName: "Skill",
  settingSkillPresetDesc: "Default skill for the next turn (loaded from .codex/skills).",
  settingCollaborationModeName: "Mode",
  settingCollaborationModeDesc: "Approval mode for requests: Safe, Prompt, or Yolo.",
  skillPresetNone: "None",
  skillPresetCodeReview: "代码评审",
  skillPresetExplain: "讲解",
  skillPresetRefactor: "重构",
  skillPresetDebug: "调试",
  skillPresetTest: "测试",
  collaborationModeAutonomous: "自主",
  collaborationModeInteractive: "交互",
  collaborationModePlanFirst: "先计划",
  settingsAllowRulesSection: "审批允许规则",
  settingsAllowRulesDesc: "命中规则的请求将自动批准，不再弹出审批卡片。",
  allowRulesEmpty: "当前没有允许规则。",
  allowRuleDelete: "删除",
  allowRulesClearAll: "清空全部",
  confirmAllowRulesClearAll: "确定清空所有允许规则？",
  allowRuleTypeCommand: "命令",
  allowRuleTypeFileWrite: "文件写入",
  allowRuleTypeTool: "工具",
  settingApprovalPolicyName: "审批策略",
  settingApprovalPolicyDesc: "新建或恢复线程时使用的审批模式。",
  settingSandboxName: "沙箱模式",
  settingSandboxDesc: "新建或恢复线程时使用的沙箱模式。",
  settingAutoApproveName: "自动批准 app-server 请求",
  settingAutoApproveDesc: "启用后，命令/文件审批回调将自动答复。",
  settingPersistThreadName: "重启后保留线程",
  settingPersistThreadDesc: "尽可能复用上次线程 ID。",
  settingSavedThreadName: "已保存线程",
  settingSavedThreadEmpty: "（无）",
  settingSavedThreadClear: "清除",
  noticeSavedThreadCleared: "已清除 Codexidian 保存的线程。",
  settingsUiSection: "界面设置",
  settingMaxTabsName: "最大标签页数",
  settingMaxTabsDesc: "最多打开标签页数量（1-5）。",
  settingContextInjectionName: "上下文注入",
  settingContextInjectionDesc: "将当前笔记路径和编辑器选区注入到提示词。",
  settingSelectionPollingName: "选区轮询",
  settingSelectionPollingDesc: "轮询编辑器选区并显示上下文指示。",
  settingEnableReviewPaneName: "启用审查面板",
  settingEnableReviewPaneDesc: "在消息区与输入区之间显示审查面板（diff + 待发送评论）。",
  settingsMcpSection: "MCP 集成",
  settingEnableMcpName: "启用 MCP 笔记工具",
  settingEnableMcpDesc: "允许 app-server 通过 Obsidian Vault API 读/写/搜/列笔记。",
  settingMcpEndpointName: "MCP 端点（可选）",
  settingMcpEndpointDesc: "用于外部 MCP/REST 桥接场景的可选端点元数据。",
  settingMcpApiKeyName: "MCP API Key（可选）",
  settingMcpApiKeyDesc: "用于外部 MCP/REST 桥接场景的可选密钥。",
  settingMcpContextLimitName: "自动 MCP 上下文笔记数",
  settingMcpContextLimitDesc: "启用 MCP 时自动附加相关笔记数量（0 为关闭）。",
  settingsSecuritySection: "安全控制",
  settingBlockedPathsName: "禁止路径",
  settingBlockedPathsDesc: "每行一个路径模式，禁止读取/写入敏感文件或目录。",
  settingRequireApprovalWriteName: "写入需审批",
  settingRequireApprovalWriteDesc: "写操作前需要显式审批（MCP write_note 与 Apply to Note）。",
  settingMaxNoteSizeName: "笔记最大大小（KB）",
  settingMaxNoteSizeDesc: "写操作后允许的笔记最大大小。",
  noticeNewThreadCreated: "Codexidian 新线程：{threadId}...",

  // MCP service/system responses surfaced to UI
  mcpDisabledMessage: "Codexidian 设置中已禁用 MCP。",
  mcpToolExecutionFailed: "MCP 工具执行失败：{error}",
};

export type I18nStrings = typeof en;
export type I18nKey = keyof I18nStrings;

const locales: Record<Locale, I18nStrings> = { en, zh };
let currentLocale: Locale = "en";

export function setLocale(locale: Locale): void {
  currentLocale = locale in locales ? locale : "en";
}

export function getLocale(): Locale {
  return currentLocale;
}

export function t(key: I18nKey): string {
  return locales[currentLocale][key];
}

export function tf(key: I18nKey, vars: Record<string, string | number>): string {
  let template = t(key);
  for (const [name, value] of Object.entries(vars)) {
    template = template.split(`{${name}}`).join(String(value));
  }
  return template;
}

export function isLocale(value: string): value is Locale {
  return value === "en" || value === "zh";
}
